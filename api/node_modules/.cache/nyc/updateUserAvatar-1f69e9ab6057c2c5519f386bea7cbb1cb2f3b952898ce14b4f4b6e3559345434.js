function cov_g5uz2re5l(){var path="/Users/macbook/workspace/isdi-parttime-202303/staff/rodrigo-castro/fullstack/api/logic/user/updateUserAvatar.js";var hash="e0c9ae9b260eb8e2ace82ee7b0705c13d1065231";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/macbook/workspace/isdi-parttime-202303/staff/rodrigo-castro/fullstack/api/logic/user/updateUserAvatar.js",statementMap:{"0":{start:{line:1,column:32},end:{line:1,column:45}},"1":{start:{line:2,column:52},end:{line:2,column:66}},"2":{start:{line:4,column:0},end:{line:39,column:1}},"3":{start:{line:5,column:4},end:{line:5,column:22}},"4":{start:{line:6,column:4},end:{line:6,column:26}},"5":{start:{line:8,column:4},end:{line:38,column:6}},"6":{start:{line:9,column:8},end:{line:13,column:9}},"7":{start:{line:10,column:12},end:{line:10,column:27}},"8":{start:{line:12,column:12},end:{line:12,column:18}},"9":{start:{line:15,column:22},end:{line:15,column:38}},"10":{start:{line:17,column:19},end:{line:17,column:57}},"11":{start:{line:17,column:38},end:{line:17,column:56}},"12":{start:{line:19,column:8},end:{line:23,column:9}},"13":{start:{line:20,column:12},end:{line:20,column:67}},"14":{start:{line:22,column:12},end:{line:22,column:18}},"15":{start:{line:25,column:8},end:{line:25,column:31}},"16":{start:{line:27,column:8},end:{line:27,column:36}},"17":{start:{line:29,column:8},end:{line:37,column:10}},"18":{start:{line:30,column:12},end:{line:34,column:13}},"19":{start:{line:31,column:16},end:{line:31,column:31}},"20":{start:{line:33,column:16},end:{line:33,column:22}},"21":{start:{line:36,column:12},end:{line:36,column:26}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:4,column:17},end:{line:4,column:18}},loc:{start:{line:4,column:50},end:{line:39,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:58},end:{line:8,column:59}},loc:{start:{line:8,column:75},end:{line:38,column:5}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:17,column:30},end:{line:17,column:31}},loc:{start:{line:17,column:38},end:{line:17,column:56}},line:17},"3":{name:"(anonymous_3)",decl:{start:{line:29,column:61},end:{line:29,column:62}},loc:{start:{line:29,column:70},end:{line:37,column:9}},line:29}},branchMap:{"0":{loc:{start:{line:9,column:8},end:{line:13,column:9}},type:"if",locations:[{start:{line:9,column:8},end:{line:13,column:9}},{start:{line:9,column:8},end:{line:13,column:9}}],line:9},"1":{loc:{start:{line:19,column:8},end:{line:23,column:9}},type:"if",locations:[{start:{line:19,column:8},end:{line:23,column:9}},{start:{line:19,column:8},end:{line:23,column:9}}],line:19},"2":{loc:{start:{line:30,column:12},end:{line:34,column:13}},type:"if",locations:[{start:{line:30,column:12},end:{line:34,column:13}},{start:{line:30,column:12},end:{line:34,column:13}}],line:30}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e0c9ae9b260eb8e2ace82ee7b0705c13d1065231"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_g5uz2re5l=function(){return actualCoverage;};}return actualCoverage;}cov_g5uz2re5l();const{readFile,writeFile}=(cov_g5uz2re5l().s[0]++,require('fs'));const{validators:{validateId,validateUrl}}=(cov_g5uz2re5l().s[1]++,require('com'));cov_g5uz2re5l().s[2]++;module.exports=(userId,avatarUrl,callback)=>{cov_g5uz2re5l().f[0]++;cov_g5uz2re5l().s[3]++;validateId(userId);cov_g5uz2re5l().s[4]++;validateUrl(avatarUrl);cov_g5uz2re5l().s[5]++;readFile(`${process.env.DB_PATH}/users.json`,'utf8',(error,json)=>{cov_g5uz2re5l().f[1]++;cov_g5uz2re5l().s[6]++;if(error){cov_g5uz2re5l().b[0][0]++;cov_g5uz2re5l().s[7]++;callback(error);cov_g5uz2re5l().s[8]++;return;}else{cov_g5uz2re5l().b[0][1]++;}const users=(cov_g5uz2re5l().s[9]++,JSON.parse(json));let user=(cov_g5uz2re5l().s[10]++,users.find(user=>{cov_g5uz2re5l().f[2]++;cov_g5uz2re5l().s[11]++;return user.id===userId;}));cov_g5uz2re5l().s[12]++;if(!user){cov_g5uz2re5l().b[1][0]++;cov_g5uz2re5l().s[13]++;callback(new Error(`user with id ${userId} not found`));cov_g5uz2re5l().s[14]++;return;}else{cov_g5uz2re5l().b[1][1]++;}cov_g5uz2re5l().s[15]++;user.avatar=avatarUrl;cov_g5uz2re5l().s[16]++;json=JSON.stringify(users);cov_g5uz2re5l().s[17]++;writeFile(`${process.env.DB_PATH}/users.json`,json,error=>{cov_g5uz2re5l().f[3]++;cov_g5uz2re5l().s[18]++;if(error){cov_g5uz2re5l().b[2][0]++;cov_g5uz2re5l().s[19]++;callback(error);cov_g5uz2re5l().s[20]++;return;}else{cov_g5uz2re5l().b[2][1]++;}cov_g5uz2re5l().s[21]++;callback(null);});});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfZzV1ejJyZTVsIiwiYWN0dWFsQ292ZXJhZ2UiLCJyZWFkRmlsZSIsIndyaXRlRmlsZSIsInMiLCJyZXF1aXJlIiwidmFsaWRhdG9ycyIsInZhbGlkYXRlSWQiLCJ2YWxpZGF0ZVVybCIsIm1vZHVsZSIsImV4cG9ydHMiLCJ1c2VySWQiLCJhdmF0YXJVcmwiLCJjYWxsYmFjayIsImYiLCJwcm9jZXNzIiwiZW52IiwiREJfUEFUSCIsImVycm9yIiwianNvbiIsImIiLCJ1c2VycyIsIkpTT04iLCJwYXJzZSIsInVzZXIiLCJmaW5kIiwiaWQiLCJFcnJvciIsImF2YXRhciIsInN0cmluZ2lmeSJdLCJzb3VyY2VzIjpbInVwZGF0ZVVzZXJBdmF0YXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyByZWFkRmlsZSwgd3JpdGVGaWxlIH0gPSByZXF1aXJlKCdmcycpXG5jb25zdCB7IHZhbGlkYXRvcnM6IHsgdmFsaWRhdGVJZCwgdmFsaWRhdGVVcmwgfSB9ID0gcmVxdWlyZSgnY29tJylcblxubW9kdWxlLmV4cG9ydHMgPSAodXNlcklkLCBhdmF0YXJVcmwsIGNhbGxiYWNrKSA9PiB7XG4gICAgdmFsaWRhdGVJZCh1c2VySWQpXG4gICAgdmFsaWRhdGVVcmwoYXZhdGFyVXJsKVxuXG4gICAgcmVhZEZpbGUoYCR7cHJvY2Vzcy5lbnYuREJfUEFUSH0vdXNlcnMuanNvbmAsICd1dGY4JywgKGVycm9yLCBqc29uKSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IpXG5cbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdXNlcnMgPSBKU09OLnBhcnNlKGpzb24pXG5cbiAgICAgICAgbGV0IHVzZXIgPSB1c2Vycy5maW5kKHVzZXIgPT4gdXNlci5pZCA9PT0gdXNlcklkKVxuXG4gICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKGB1c2VyIHdpdGggaWQgJHt1c2VySWR9IG5vdCBmb3VuZGApKVxuXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIHVzZXIuYXZhdGFyID0gYXZhdGFyVXJsXG5cbiAgICAgICAganNvbiA9IEpTT04uc3RyaW5naWZ5KHVzZXJzKVxuXG4gICAgICAgIHdyaXRlRmlsZShgJHtwcm9jZXNzLmVudi5EQl9QQVRIfS91c2Vycy5qc29uYCwganNvbiwgZXJyb3IgPT4ge1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IpXG5cbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FsbGJhY2sobnVsbClcbiAgICAgICAgfSlcbiAgICB9KVxufSJdLCJtYXBwaW5ncyI6Imt0R0FlWTtBQUFBQSxhQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGFBQUEsR0FmWixLQUFNLENBQUVFLFFBQVEsQ0FBRUMsU0FBVSxDQUFDLEVBQUFILGFBQUEsR0FBQUksQ0FBQSxNQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQzdDLEtBQU0sQ0FBRUMsVUFBVSxDQUFFLENBQUVDLFVBQVUsQ0FBRUMsV0FBWSxDQUFFLENBQUMsRUFBQVIsYUFBQSxHQUFBSSxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBQUwsYUFBQSxHQUFBSSxDQUFBLE1BRWxFSyxNQUFNLENBQUNDLE9BQU8sQ0FBRyxDQUFDQyxNQUFNLENBQUVDLFNBQVMsQ0FBRUMsUUFBUSxHQUFLLENBQUFiLGFBQUEsR0FBQWMsQ0FBQSxNQUFBZCxhQUFBLEdBQUFJLENBQUEsTUFDOUNHLFVBQVUsQ0FBQ0ksTUFBTSxDQUFDLENBQUFYLGFBQUEsR0FBQUksQ0FBQSxNQUNsQkksV0FBVyxDQUFDSSxTQUFTLENBQUMsQ0FBQVosYUFBQSxHQUFBSSxDQUFBLE1BRXRCRixRQUFRLENBQUUsR0FBRWEsT0FBTyxDQUFDQyxHQUFHLENBQUNDLE9BQVEsYUFBWSxDQUFFLE1BQU0sQ0FBRSxDQUFDQyxLQUFLLENBQUVDLElBQUksR0FBSyxDQUFBbkIsYUFBQSxHQUFBYyxDQUFBLE1BQUFkLGFBQUEsR0FBQUksQ0FBQSxNQUNuRSxHQUFJYyxLQUFLLENBQUUsQ0FBQWxCLGFBQUEsR0FBQW9CLENBQUEsU0FBQXBCLGFBQUEsR0FBQUksQ0FBQSxNQUNQUyxRQUFRLENBQUNLLEtBQUssQ0FBQyxDQUFBbEIsYUFBQSxHQUFBSSxDQUFBLE1BRWYsT0FDSixDQUFDLEtBQUFKLGFBQUEsR0FBQW9CLENBQUEsVUFFRCxLQUFNLENBQUFDLEtBQUssRUFBQXJCLGFBQUEsR0FBQUksQ0FBQSxNQUFHa0IsSUFBSSxDQUFDQyxLQUFLLENBQUNKLElBQUksQ0FBQyxFQUU5QixHQUFJLENBQUFLLElBQUksRUFBQXhCLGFBQUEsR0FBQUksQ0FBQSxPQUFHaUIsS0FBSyxDQUFDSSxJQUFJLENBQUNELElBQUksRUFBSSxDQUFBeEIsYUFBQSxHQUFBYyxDQUFBLE1BQUFkLGFBQUEsR0FBQUksQ0FBQSxjQUFBb0IsSUFBSSxDQUFDRSxFQUFFLEdBQUtmLE1BQU0sQ0FBRCxDQUFDLENBQUMsRUFBQVgsYUFBQSxHQUFBSSxDQUFBLE9BRWpELEdBQUksQ0FBQ29CLElBQUksQ0FBRSxDQUFBeEIsYUFBQSxHQUFBb0IsQ0FBQSxTQUFBcEIsYUFBQSxHQUFBSSxDQUFBLE9BQ1BTLFFBQVEsQ0FBQyxHQUFJLENBQUFjLEtBQUssQ0FBRSxnQkFBZWhCLE1BQU8sWUFBVyxDQUFDLENBQUMsQ0FBQVgsYUFBQSxHQUFBSSxDQUFBLE9BRXZELE9BQ0osQ0FBQyxLQUFBSixhQUFBLEdBQUFvQixDQUFBLFVBQUFwQixhQUFBLEdBQUFJLENBQUEsT0FFRG9CLElBQUksQ0FBQ0ksTUFBTSxDQUFHaEIsU0FBUyxDQUFBWixhQUFBLEdBQUFJLENBQUEsT0FFdkJlLElBQUksQ0FBR0csSUFBSSxDQUFDTyxTQUFTLENBQUNSLEtBQUssQ0FBQyxDQUFBckIsYUFBQSxHQUFBSSxDQUFBLE9BRTVCRCxTQUFTLENBQUUsR0FBRVksT0FBTyxDQUFDQyxHQUFHLENBQUNDLE9BQVEsYUFBWSxDQUFFRSxJQUFJLENBQUVELEtBQUssRUFBSSxDQUFBbEIsYUFBQSxHQUFBYyxDQUFBLE1BQUFkLGFBQUEsR0FBQUksQ0FBQSxPQUMxRCxHQUFJYyxLQUFLLENBQUUsQ0FBQWxCLGFBQUEsR0FBQW9CLENBQUEsU0FBQXBCLGFBQUEsR0FBQUksQ0FBQSxPQUNQUyxRQUFRLENBQUNLLEtBQUssQ0FBQyxDQUFBbEIsYUFBQSxHQUFBSSxDQUFBLE9BRWYsT0FDSixDQUFDLEtBQUFKLGFBQUEsR0FBQW9CLENBQUEsVUFBQXBCLGFBQUEsR0FBQUksQ0FBQSxPQUVEUyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQ2xCLENBQUMsQ0FBQyxDQUNOLENBQUMsQ0FBQyxDQUNOLENBQUMifQ==